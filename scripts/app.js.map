{"version":3,"sources":["../../../app/scripts/logger.js","../../../app/scripts/util.js","../../../app/scripts/modal.js","../../../app/scripts/safari.js","../../../app/scripts/analytics.js","../../../app/scripts/psprint.js","../../../app/scripts/logaster.js","../../../app/scripts/gorgiastemplates.js","../../../app/scripts/laborday.js","../../../app/scripts/themes.js","../../../app/scripts/pdf.js","../../../app/scripts/app.js","../../../app/scripts/directives/fileread.js","../../../app/scripts/directives/drag.js","../../../app/scripts/controllers/main.js","../../scripts/templates.js"],"names":["window","originalWindowErrorCallback","onerror","errorMessage","url","lineNumber","columnNumber","errorObject","indexOf","ga","exceptionDescription","message","exDescription","hash","key","hashFull","location","substr","hashValue","split","closest","$elem","selector","$matches","document","parentNode","querySelectorAll","call","hasClass","node","className","tempClass","addClass","removeClass","spaceBefore","spaceAfter","replace","util","$","on","body","localStorage","setItem","removeItem","e","Storage","prototype","_setItem","isSafari","navigator","userAgent","$warning","querySelector","events","arguments","clickElement","nativeEvent","some","event","target","apply","concat","addEventListener","openPsprintPage","open","$modal","showLogasterModal","foundation","closeModal","classList","contains","preventDefault","timeAgo","dateString","Date","now","parseInt","expiry","hidePopup","$popup","add","hideClass","storageKey","String","showPopup","closedTime","getItem","remove","setTimeout","init","$popover","before","after","active","style","display","hashChange","themeActive","$container","click","$themeActive","GeneratePdf","config","card","margin","trim","cardWidth","cardHeight","trimWithMargin","marginWithoutTrim","trimLines","x","y","x1","y1","name","imgData","doc","jsPDF","addImage","forEach","line","setLineWidth","save","app","angular","module","run","$rootScope","root","directive","scope","fileread","link","element","bind","changeEvent","$apply","files","$document","$timeout","template","drModel","drContainer","drGrid","transclude","$body","getElementsByTagName","scrollTop","scrollLeft","$dragHandle","$resizeHandle","transformPrefixes","startX","startY","minX","maxX","minY","maxY","dragActive","resizeActive","grid","maxGrid","val","Math","floor","setContainment","argument","dragRect","getBoundingClientRect","containerRect","dragStartY","top","dragStartX","left","height","width","restrictGrid","mousemove","touches","pageX","pageY","translate","prefix","css","newHeight","_startHeight","newWidth","_startWidth","mouseup","offsetLeft","offsetTop","bottom","right","mousedown","elem","disableScroll","emulateTouch","clientX","clientY","setModel","$watch","controller","$scope","$routeParams","$location","$q","model","cardPictureFile","cardPicture","imageData","imageFilename","imageExt","pdfData","pdfFilename","loadingCard","expire","setDate","getDate","promoExpire","storeDefaults","position","organization","phone","email","picture","person","details","store","copy","storedDetails","extend","fromJson","fn","delay","timer","context","this","args","clearTimeout","toJson","clearInlineStyles","cardChildren","c","removeAttribute","ResetCard","change","previousTheme","theme","search","$on","imageType","type","match","reader","FileReader","onload","result","readAsDataURL","alert","pxToEm","parentStyle","getComputedStyle","childFontSize","parseFloat","fontSize","parentFontSize","properties","inlineStyleValue","newValues","prop","childValue","newValue","emSize","Object","keys","tagName","toLowerCase","fontSizes","1","2","3","4","5","6","7","fixPxSizes","container","children","editors","size","lists","li","generatePicture","cb","deferred","defer","getSelection","removeAllRanges","$cardClone","cloneNode","appendChild","html2canvas","letterRendering","then","canvas","removeChild","resolve","promise","DownloadPdf","toDataURL","DownloadPicture","toBlob","blob","filename","saveAs","scrollIntoView","loadedTemplates","$cardContent","passiveSupported","defineProperty","get","err","passive","$templateCache","put"],"mappings":"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","file":"app.js","sourcesContent":["/**\n * Send JavaScript error information to Google Analytics.\n *\n * @param  {Window} window A reference to the \"window\".\n * @return {void}\n * @author Philippe Sawicki <https://github.com/philsawicki>\n */\n(function (window) {\n    'use strict';\n\n    // Retain a reference to the previous global error handler, in case it has been set:\n    var originalWindowErrorCallback = window.onerror;\n\n    /**\n     * Log any script error to Google Analytics.\n     *\n     * Third-party scripts without CORS will only provide \"Script Error.\" as an error message.\n     *\n     * @param  {String}           errorMessage Error message.\n     * @param  {String}           url          URL where error was raised.\n     * @param  {Number}           lineNumber   Line number where error was raised.\n     * @param  {Number|undefined} columnNumber Column number for the line where the error occurred.\n     * @param  {Object|undefined} errorObject  Error Object.\n     * @return {Boolean}                       When the function returns true, this prevents the\n     *                                         firing of the default event handler.\n     */\n    window.onerror = function customErrorHandler (errorMessage, url, lineNumber, columnNumber, errorObject) {\n        // only track events from our scripts\n        url = url || '';\n        if(url.indexOf('//www.bizcardmaker.com/') === -1) {\n          return;\n        }\n\n        // Send error details to Google Analytics, if the library is already available:\n        if (typeof ga === 'function') {\n            // In case the \"errorObject\" is available, use its data, else fallback\n            // on the default \"errorMessage\" provided:\n            var exceptionDescription = errorMessage;\n            if (typeof errorObject !== 'undefined' && typeof errorObject.message !== 'undefined') {\n                exceptionDescription = errorObject.message;\n            }\n\n            // Format the message to log to Analytics (might also use \"errorObject.stack\" if defined):\n            exceptionDescription += ' @ ' + url + ':' + lineNumber + ':' + columnNumber;\n\n            ga('send', 'exception', {\n                'exDescription': exceptionDescription\n            });\n        }\n\n        // If the previous \"window.onerror\" callback can be called, pass it the data:\n        if (typeof originalWindowErrorCallback === 'function') {\n            return originalWindowErrorCallback(errorMessage, url, lineNumber, columnNumber, errorObject);\n        }\n        // Otherwise, Let the default handler run:\n        return false;\n    };\n})(window);\n","/* utils\n */\n\n(function () {\n  'use strict';\n\n  function hash (key) {\n    var hashFull = window.location.hash.substr(1);\n    var hashValue = hashFull.substr(hashFull.indexOf(key + '=')).split('&')[0].split('=')[1];\n\n    if (!hashValue) {\n      return null;\n    }\n\n    return hashValue;\n  }\n\n  function closest ($elem, selector) {\n    // traverse the dom up and find the closest parent\n    // that matches the selector.\n    // include the current element.\n    var $matches;\n\n    // loop through parents\n    while ($elem && $elem !== document) {\n      if ($elem.parentNode) {\n        // find all siblings that match the selector\n        $matches = $elem.parentNode.querySelectorAll(selector);\n        // check if our element is matched (poor-man's Element.matches())\n        if ([].indexOf.call($matches, $elem) !== -1) {\n          return $elem;\n        }\n\n        // go up the tree\n        $elem = $elem.parentNode;\n      } else {\n        return null;\n      }\n    }\n\n    return null;\n  }\n\n  function hasClass (node, className) {\n    if (!node.className) {\n      return false;\n    }\n    var tempClass = ' ' + node.className + ' ';\n    className = ' ' + className + ' ';\n\n    if (tempClass.indexOf(className) !== -1) {\n      return true;\n    }\n\n    return false;\n  }\n\n  function addClass (node, className) {\n    // class is already added\n    if (hasClass(node, className)) {\n      return node.className;\n    }\n\n    if (node.className) {\n      className = ' ' + className;\n    }\n\n    node.className += className;\n\n    return node.className;\n  }\n\n  function removeClass (node, className) {\n    var spaceBefore = ' ' + className;\n    var spaceAfter = className + ' ';\n\n    if (node.className.indexOf(spaceBefore) !== -1) {\n      node.className = node.className.replace(spaceBefore, '');\n    } else if (node.className.indexOf(spaceAfter) !== -1) {\n      node.className = node.className.replace(spaceAfter, '');\n    } else {\n      node.className = node.className.replace(className, '');\n    }\n\n    return node.className;\n  }\n\n  window.util = {\n    closest: closest,\n    hash: hash,\n\n    hasClass: hasClass,\n    addClass: addClass,\n    removeClass: removeClass\n  };\n})();","/* foundation modal tweaks\n */\n\n(function() {\n  'use strict';\n\n  // add a class on the body, when the modal is opened\n  // so we can set position: fixed on the background.\n  $(document).on('opened', '[data-reveal]', function () {\n    $(document.body).addClass('modal-opened');\n  });\n\n  $(document).on('closed', '[data-reveal]', function () {\n    $(document.body).removeClass('modal-opened');\n  });\n})();\n","/* safari tweaks\n*/\n\n(function() {\n  'use strict';\n\n  // Safari, in Private Browsing Mode, looks like it supports localStorage\n  // but all calls to setItem throw QuotaExceededError.\n  if (typeof localStorage === 'object') {\n    try {\n      localStorage.setItem('localStorage', 1);\n      localStorage.removeItem('localStorage');\n    } catch (e) {\n      window.Storage.prototype._setItem = window.Storage.prototype.setItem;\n      window.Storage.prototype.setItem = function() {};\n    }\n  }\n\n  // ugly detection for ugly Safari\n  var isSafari = (navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1);\n\n  // show a notice if using safari\n  var $warning = document.querySelector('.warning-safari');\n\n  if (isSafari) {\n    $warning.className += 'warning-safari-show';\n  }\n})();","/* track analytics\n*/\n\n(function() {\n  'use strict';\n\n  var events = [\n    {\n      selector: '.js-track-order',\n      arguments: ['Orders', 'Clicked PsPrint button'],\n    },\n    {\n      selector: '.js-track-pdf',\n      arguments: ['Download', 'Download PDF'],\n    },\n    {\n      selector: '.js-track-picture',\n      arguments: ['Download', 'Download picture'],\n    },\n  ];\n\n  var clickElement = function (nativeEvent) {\n    events.some(function (event) {\n      if (window.util.closest(nativeEvent.target, event.selector)) {\n        ga.apply(null, ['send', 'event'].concat(event.arguments));\n        return true;\n      }\n    });\n  };\n\n  document.body.addEventListener('click', clickElement);\n})();\n","/* psprint order button\n*/\n\n(function() {\n  'use strict';\n\n  var link = 'http://www.shareasale.com/r.cfm?b=283670&u=1215865&m=22819&urllink=&afftrack=';\n  var $btn = document.querySelector('.js-order-btn-psprint');\n\n  var openPsprintPage = function (e) {\n    if (!window.util.closest(e.target, '.js-order-btn-psprint')) {\n      return;\n    }\n\n    // open the url\n    window.open(link, 'psprint');\n  };\n\n  document.body.addEventListener('click', openPsprintPage);\n})();\n","/* logaster modal\n*/\n\n(function() {\n  'use strict';\n\n  var $modal = document.querySelector('.js-modal-logaster');\n\n  // if we're on a page without the modal\n  if (!$modal) {\n    return;\n  }\n\n  var showLogasterModal = function (e) {\n    if (!window.util.closest(e.target, '.js-btn-logaster')) {\n      return;\n    }\n\n    // open the reveal modal\n    $($modal).foundation('open');\n  };\n\n  var closeModal = function (e) {\n    if (!e.target.classList.contains('js-close-modal')) {\n      return;\n    }\n\n    $($modal).foundation('close');\n    e.preventDefault();\n  };\n\n  $modal.addEventListener('click', closeModal);\n  document.body.addEventListener('click', showLogasterModal);\n})();\n","/* gorgias templates popup\n*/\n\n(function() {\n  'use strict';\n\n  var $popup = document.querySelector('.js-gtemplates-popup');\n  if (!$popup) {\n    return;\n  }\n\n  var hideClass = 'gtemplates-popup-hide';\n  var storageKey = 'gtemplates-popup';\n  var closedTime = null;\n  var expiry = 1000 * 60 * 60 * 24;\n\n  function timeAgo (dateString) {\n    if (!dateString) {\n      return true;\n    }\n\n    var difference = Date.now() - parseInt(dateString, 10);\n    return difference > expiry;\n  }\n\n  function hidePopup () {\n    $popup.classList.add(hideClass);\n    window.localStorage.setItem(storageKey, String(Date.now()));\n  }\n\n  var $closeBtn = $popup.querySelector('.js-gtemplates-close');\n  $closeBtn.addEventListener('click', hidePopup);\n\n  function showPopup () {\n    closedTime = window.localStorage.getItem(storageKey);\n    if (timeAgo(closedTime)) {\n      $popup.classList.remove(hideClass);\n    }\n  }\n\n  setTimeout(function () {\n    showPopup();\n  }, 2000);\n})();\n","/* laborday-promo\n*/\n\n(function() {\n  'use strict';\n\n  var init = function () {\n    var $popover = document.querySelector('.js-laborday-promo');\n\n    // TODO check date\n    var before = new Date('08-28-2018');\n    var after = new Date('09-11-2018');\n    var now = new Date();\n    var active = (now >= before && now <= after);\n\n    // if we're on a page without the popover\n    // or promo not active\n    if (!$popover || !active) {\n      return;\n    }\n\n    $popover.style.display = 'block';\n  };\n\n  // wait for the angular app to load\n  setTimeout(init, 3000);\n\n})();\n","/* theme selector\n*/\n\n(function() {\n  'use strict';\n\n  var themeActive = '';\n  var $themeActive;\n  var $container = document.querySelector('.themes-box');\n\n  // if we're on a page without the themes\n  if (!$container) {\n    return;\n  }\n\n  function hashChange () {\n    themeActive = window.util.hash('theme');\n\n    // if no theme in the url\n    if (!themeActive) {\n      // select the first in the list\n      $container.querySelector('.theme-item').click();\n\n      return;\n    }\n\n    // uncheck previous active theme\n    $themeActive = $container.querySelector('.active');\n    if ($themeActive) {\n      window.util.removeClass($themeActive, 'active');\n    }\n\n    $themeActive = $container.querySelector('.js-' + themeActive);\n    if ($themeActive) {\n      window.util.addClass($themeActive, 'active');\n    }\n  }\n\n  hashChange();\n  window.addEventListener('hashchange', hashChange, false);\n})();\n","/* PDF generation for final printing.\n */\n\nwindow.GeneratePdf = (function () {\n  'use strict';\n\n  var config =  {\n    card: [ 3.75, 2.25 ],\n    margin: 0.35,\n    trim: 0.125\n  };\n\n  var cardWidth = config.card[0];\n  var cardHeight = config.card[1];\n\n  var trim = config.trim;\n  var trimWithMargin = trim + config.margin;\n  var marginWithoutTrim = config.margin - trim;\n  var trimSubstract = 0.06;\n\n  var trimLines = [\n    // top left\n    {\n      x: trimWithMargin,\n      y: trimSubstract,\n      x1: trimWithMargin,\n      y1: trimWithMargin - trimSubstract\n    },\n    {\n      x: trimSubstract,\n      y: trimWithMargin,\n      x1: trimWithMargin - trimSubstract,\n      y1: trimWithMargin\n    },\n\n    // top right\n    {\n      x: cardWidth + marginWithoutTrim,\n      y: trimSubstract,\n      x1: cardWidth + marginWithoutTrim,\n      y1: trimWithMargin - trimSubstract\n    },\n    {\n      x: cardWidth + marginWithoutTrim + trimSubstract,\n      y: trimWithMargin,\n      x1: cardWidth + (config.margin * 2) - trimSubstract,\n      y1: trimWithMargin\n    },\n\n    // bottom left\n    {\n      x: trimWithMargin,\n      y: cardHeight + marginWithoutTrim + trimSubstract,\n      x1: trimWithMargin,\n      y1: cardHeight + (config.margin * 2) - trimSubstract\n    },\n    {\n      x: trimSubstract,\n      y: cardHeight + marginWithoutTrim,\n      x1: trimWithMargin - trimSubstract,\n      y1: cardHeight + marginWithoutTrim\n    },\n\n    // bottom right\n    {\n      x: cardWidth + marginWithoutTrim,\n      y: cardHeight + marginWithoutTrim + trimSubstract,\n      x1: cardWidth + marginWithoutTrim,\n      y1: cardHeight + (config.margin * 2) - trimSubstract\n    },\n    {\n      x: cardWidth + marginWithoutTrim + trimSubstract,\n      y: cardHeight + marginWithoutTrim,\n      x1: cardWidth + (config.margin * 2) - trimSubstract,\n      y1: cardHeight + marginWithoutTrim\n    }\n  ];\n\n  return function(name, imgData) {\n    var doc = new jsPDF('landscape', 'in', [\n      cardWidth + config.margin * 2,\n      cardHeight + config.margin * 2\n    ]);\n\n    doc.addImage(imgData, 'JPEG', config.margin, config.margin, cardWidth, cardHeight);\n\n    // write the trim lines\n    trimLines.forEach(function(line) {\n      doc.setLineWidth(0.01);\n      doc.line(line.x, line.y, line.x1, line.y1);\n    });\n\n    doc.save(name);\n  };\n}());\n","/* Business Card Maker app\n*/\n\nvar app = angular.module('businessCardMaker', [\n  'ngRoute',\n  'angular-meditor'\n]);\n\napp.run([ '$rootScope', function($rootScope){\n  'use strict';\n\n  var root = $rootScope.root = {};\n}]);\n\n","/* fileread directive\n* for uploading files\n*/\n\napp.directive('fileread', [function () {\n  'use strict';\n\n  return {\n    scope: {\n      fileread: '='\n    },\n    link: function (scope, element) {\n      element.bind('change', function (changeEvent) {\n        scope.$apply(function () {\n          scope.fileread = changeEvent.target.files[0];\n          // or all selected files:\n          // scope.fileread = changeEvent.target.files;\n        });\n      });\n    }\n  };\n}]);\n","/* DragResize directive\n */\n\napp.directive('drModel', [\n'$document', '$timeout',\nfunction ($document, $timeout) {\n  'use strict';\n\n  return {\n    template: '<div class=\"dr-container\">' +\n    '<div class=\"drag-handle\"></div>' +\n    '<div class=\"resize-handle\"></div>' +\n    '<div ng-transclude></div>' +\n    '</div>',\n    scope: {\n      drModel: '=',\n      drContainer: '@',\n      drGrid: '@'\n    },\n    replace: true,\n    transclude: true,\n    link: function (scope, element) {\n\n      var classDrActive = 'dr-active';\n      var classDrShow = 'dr-handle-show';\n\n      var $body = document.getElementsByTagName('body')[0];\n      var $container = $body;\n\n      if(scope.drContainer) {\n        $container = document.querySelector(scope.drContainer);\n      }\n\n      var $dragHandle = element[0].querySelector('.drag-handle');\n      var $resizeHandle = element[0].querySelector('.resize-handle');\n\n      var transformPrefixes = [\n        'webkitTransform',\n        'msTransform',\n        'transform'\n      ];\n\n      var startX = 0;\n      var startY = 0;\n      var x = 0;\n      var y = 0;\n\n      var minX = 0;\n      var maxX = 0;\n      var minY = 0;\n      var maxY = 0;\n\n      var dragActive = false;\n      var resizeActive = false;\n\n      var grid = scope.drGrid;\n\n      var maxGrid = function (val) {\n        return Math.floor(val/grid) * grid;\n      };\n\n      var setContainment = function (argument) {\n\n        // get size and position\n        var dragRect = $dragHandle.getBoundingClientRect();\n        var containerRect = $container.getBoundingClientRect();\n\n        var dragStartY = dragRect.top;\n        var dragStartX = dragRect.left;\n\n        minY = dragStartY - containerRect.top;\n        minY = 0 - maxGrid(minY);\n\n        maxY = (containerRect.top + containerRect.height) - dragStartY - dragRect.height;\n        maxY = maxGrid(maxY);\n\n        minX = dragStartX - containerRect.left;\n        minX = 0 - maxGrid(minX);\n\n        maxX = (containerRect.left + containerRect.width) - dragStartX - dragRect.width;\n        maxX = maxGrid(maxX);\n\n      };\n\n      var restrictGrid = function (val) {\n        return (val % grid === 0) ? val : val - val % grid;\n      };\n\n      var mousemove = function (e) {\n\n        if(!dragActive && !resizeActive) {\n          return;\n        }\n\n        // disable text selection\n        e.preventDefault();\n\n        x = restrictGrid(e.touches[0].pageX - startX);\n        y = restrictGrid(e.touches[0].pageY - startY);\n\n        if (x > maxX) {\n          x = maxX;\n        }\n        if (y > maxY) {\n          y = maxY;\n        }\n\n        // drag\n        if(dragActive) {\n          if (x < minX) {\n            x = minX;\n          }\n          if (y < minY) {\n            y = minY;\n          }\n\n          var translate = 'translate3d(' + x + 'px ,' + y + 'px, 0)';\n\n          angular.forEach(transformPrefixes, function(prefix) {\n            element.css(prefix, translate);\n          });\n        }\n\n        // resize\n        if(resizeActive) {\n          var newHeight = element._startHeight + y;\n          element.css('height', newHeight);\n\n          var newWidth = element._startWidth + x;\n          element.css('width', newWidth);\n        }\n\n      };\n\n      var mouseup = function (e) {\n\n        if(!dragActive && !resizeActive) {\n          return;\n        }\n\n        if(dragActive) {\n          dragActive = false;\n\n          // remove transforms and set distance in px\n          angular.forEach(transformPrefixes, function(prefix) {\n            element.css(prefix, '');\n          });\n\n          var left = x;\n          var top = y;\n\n          if(element.css('position') === 'absolute') {\n\n            // absolute elements\n            left += element[0].offsetLeft;\n            top += element[0].offsetTop;\n\n          } else {\n\n            // relative elements\n            if(element.css('left') && element.css('left') !== 'auto') {\n              left = parseInt(element.css('left'), 10) + x;\n            }\n\n            if(element.css('top') && element.css('top') !== 'auto') {\n              top = parseInt(element.css('top'), 10) + y;\n            }\n\n          }\n\n          element.css({\n            top:  top,\n            left:  left,\n            bottom: 'auto',\n            right: 'auto'\n          });\n\n          // set positions in model\n          if(scope.drModel) {\n            scope.drModel.x = left;\n            scope.drModel.y = top;\n          }\n        }\n\n        if(resizeActive) {\n          resizeActive = false;\n\n          // set sizes in model\n          if(scope.drModel) {\n            scope.drModel.width = parseInt(element.css('width'));\n            scope.drModel.height = parseInt(element.css('height'));\n          }\n        }\n\n        // remove active classes\n        $body.classList.remove(classDrActive);\n        element[0].classList.remove(classDrShow);\n\n      };\n\n      var mousedown = function(e) {\n\n        var elem = e.target;\n\n        // recalculate containment\n        setContainment();\n\n        x = y = 0;\n\n        startX = e.touches[0].pageX - x;\n        startY = e.touches[0].pageY - y;\n\n        // resize\n        if(elem === $resizeHandle) {\n          resizeActive = true;\n\n          //element._startY = event.pageY;\n          element._startHeight = parseInt(element.css('height'));\n          element._startWidth = parseInt(element.css('width'));\n        } else {\n          // drag\n          dragActive = true;\n        }\n\n        $body.classList.add(classDrActive);\n        element[0].classList.add(classDrShow);\n\n      };\n\n      // disable window scrolling when moving the mouse\n      // to the window margins or\n      // in the browser chrome and back in\n      var scrollTop;\n      var scrollLeft;\n\n      var disableScroll = function(e) {\n\n        if(!dragActive) {\n          scrollTop = $body.scrollTop;\n          scrollLeft = $body.scrollLeft;\n\n          return;\n        }\n\n        $body.scrollTop = scrollTop;\n        $body.scrollLeft = scrollLeft;\n\n      };\n\n      var emulateTouch = function(e) {\n\n        e.touches = [{\n          clientX: e.clientX,\n          clientY: e.clientY,\n          pageX: e.pageX,\n          pageY: e.pageY\n        }];\n\n        return e;\n\n      };\n\n      var setModel = function() {\n\n        scope.drModel.x = scope.drModel.x || '';\n        element.css({\n          left: scope.drModel.x\n        });\n\n        scope.drModel.y = scope.drModel.y || '';\n        element.css({\n          top: scope.drModel.y\n        });\n\n        scope.drModel.width = scope.drModel.width || '';\n        element.css({\n          width: scope.drModel.width\n        });\n\n        scope.drModel.height = scope.drModel.height || '';\n        element.css({\n          height: scope.drModel.height\n        });\n\n      };\n\n      scope.$watch('drModel', setModel, true);\n\n      $resizeHandle.addEventListener('mousedown', function(e) {\n        mousedown(emulateTouch(e));\n      });\n      $resizeHandle.addEventListener('touchstart', mousedown);\n\n      $dragHandle.addEventListener('mousedown', function(e) {\n        mousedown(emulateTouch(e));\n      });\n      $dragHandle.addEventListener('touchstart', mousedown);\n\n      document.addEventListener('mousemove', function(e) {\n        mousemove(emulateTouch(e));\n      });\n      document.addEventListener('touchmove', mousemove);\n\n      document.addEventListener('mouseup', mouseup);\n      document.addEventListener('touchend', mouseup);\n\n      // don't scroll when moving to the window sides\n      window.addEventListener('scroll', disableScroll);\n\n    }\n  };\n}]);\n","app.controller('MainCtrl', [\n'$rootScope', '$scope', '$routeParams', '$location', '$timeout', '$q',\nfunction($rootScope, $scope, $routeParams, $location, $timeout, $q) {\n  'use strict';\n\n  var model = $scope.model = {};\n\n  model.cardPictureFile = '';\n  model.cardPicture = '';\n\n  model.imageData = '';\n  model.imageFilename = 'bizcardmaker-com';\n  model.imageExt = '.jpg';\n\n  model.pdfData = '';\n  model.pdfFilename = 'bizcardmaker-com.pdf';\n\n  model.loadingCard = false;\n\n  var expire = new Date();\n  expire.setDate(expire.getDate() + 23);\n  model.promoExpire = expire;\n\n  model.storeDefaults = {\n    card: {\n      name: 'John Doe',\n      position: 'Position',\n      organization: 'Organization',\n      location: 'City, State',\n      phone: '(123) 555-1234',\n      email: 'john.doe@cmail.com',\n      url: 'www.john-doe.com'\n    },\n    position: {\n      picture: {},\n      person: {},\n      details: {},\n      email: {},\n      url: {}\n    }\n  };\n\n  model.store = {\n    card: {},\n    position: {}\n  };\n\n  angular.copy(model.storeDefaults, model.store);\n\n  var storedDetails = window.localStorage.getItem('bizcardmaker-store');\n\n  if(storedDetails) {\n    angular.extend(model.store, angular.fromJson(storedDetails));\n  }\n\n  // Remy Sharp's debounce\n  // https://remysharp.com/2010/07/21/throttling-function-calls\n  var debounce = function(fn, delay) {\n    var timer = null;\n    return function () {\n      var context = this, args = arguments;\n      clearTimeout(timer);\n      timer = setTimeout(function () {\n        fn.apply(context, args);\n      }, delay);\n    };\n  };\n\n  // save edits to localstorage\n  $scope.$watch('model.store', debounce(function(store) {\n\n    window.localStorage.setItem('bizcardmaker-store', angular.toJson(store));\n\n  }, 500), true);\n\n  var clearInlineStyles = function() {\n    if (!document.querySelector('.card-preview')) {\n      return;\n    }\n\n    // clear all inline styles\n    // generated by editor and draggable\n    var cardChildren = document.querySelector('.card-preview').querySelectorAll('*');\n    angular.forEach(cardChildren, function(c) {\n      c.removeAttribute('style');\n    });\n  };\n\n  // reset all saved data\n  $scope.ResetCard = function(change) {\n\n    clearInlineStyles();\n\n    if(change) {\n\n      // on change, only reset the positions\n      angular.copy(model.storeDefaults.position, model.store.position);\n\n    } else {\n\n      // complete reset\n      var previousTheme = model.store.theme;\n\n      angular.copy(model.storeDefaults, model.store);\n\n      // don't reset the currently selected theme\n      model.store.theme = previousTheme;\n    }\n\n\n    window.localStorage.removeItem('bizcardmaker-store');\n\n  };\n\n  // if we have a stored theme\n  // set it as active.\n  if (model.store.theme) {\n    $location.search('theme', model.store.theme);\n  }\n\n  $scope.$on('$locationChangeStart', function(){\n    var theme = $location.search().theme;\n\n    // reset card styles when changing themes\n    // except the text data\n    if(theme !== model.store.theme) {\n      $scope.ResetCard(true);\n    }\n\n    model.store.theme = theme;\n  });\n\n  $scope.$watch('model.cardPictureFile', function() {\n\n    if(model.cardPictureFile) {\n\n      var imageType = /image.*/;\n\n      if (model.cardPictureFile.type.match(imageType)) {\n        var reader = new FileReader();\n\n        reader.onload = function() {\n\n          $timeout(function() {\n            model.cardPicture = reader.result;\n          });\n\n        };\n\n        reader.readAsDataURL(model.cardPictureFile);\n\n      } else {\n\n        window.alert('File not supported!');\n\n      }\n\n    }\n\n  });\n\n  /* Turn px values into em\n   */\n  var pxToEm = function(elem) {\n\n    var parentStyle = window.getComputedStyle(elem.parentNode, null);\n    var style = window.getComputedStyle(elem, null);\n    var childFontSize = parseFloat(style.fontSize);\n    var parentFontSize = parseFloat(parentStyle.fontSize);\n\n    var properties = [ 'left', 'top', 'width', 'height' ];\n    var inlineStyleValue = '';\n\n    var newValues = {};\n\n    properties.forEach(function(prop) {\n\n      inlineStyleValue = elem.style[prop];\n\n      // only if the property is set as inline style\n      if(inlineStyleValue && inlineStyleValue.indexOf('em') === -1) {\n\n        // var childValue = parseFloat(style[prop]);\n        var childValue = parseFloat(style[prop]);\n        var newValue = childValue / parentFontSize;\n\n        // recalculate depending on element fontSize\n        // since it influences ems\n        var emSize = childFontSize / parentFontSize;\n        newValue += (newValue - newValue * emSize) / emSize;\n\n        //elem.style[prop] = newValue + 'em';\n        newValues[prop] = newValue + 'em';\n\n      }\n\n    });\n\n    // change all values at the same time, for performance\n    Object.keys(newValues).forEach(function(key) {\n      elem.style[key] = newValues[key];\n    });\n\n    // convert fontSize to em, only for font tags\n    if(elem.tagName.toLowerCase() === 'font' && style.fontSize.indexOf('em') === -1) {\n      elem.style.fontSize = childFontSize / parentFontSize + 'em';\n    }\n\n  };\n\n  var fontSizes = {\n    '1': '10',\n    '2': '13',\n    '3': '16',\n    '4': '18',\n    '5': '24',\n    '6': '32',\n    '7': '48'\n  };\n\n  // replace px styles and font sizes generated by the editor\n  // so that I can later enlarge the entire business card with ems\n  var fixPxSizes = function(container) {\n    var editors = container.querySelectorAll('[contenteditable]');\n\n    var children;\n\n    angular.forEach(editors, function(e) {\n      children = e.querySelectorAll('*');\n      angular.forEach(children, function(c) {\n        // first turn font size=x to px\n        if(c.tagName.toLowerCase() === 'font') {\n          c.style.fontSize = fontSizes[c.size] + 'px';\n        }\n\n        pxToEm(c);\n      });\n    });\n\n    // fix dragged positions\n    var lists = container.querySelectorAll('.card-item[style]');\n    var picture = container.querySelector('.card-picture[style]');\n\n    angular.forEach(lists, function(li) {\n      pxToEm(li);\n    });\n\n    if(picture) {\n      pxToEm(picture);\n    }\n\n  };\n\n  // place business card on a canvas\n  $scope.generatePicture = function(cb) {\n    cb = cb || function() {};\n\n    var deferred = $q.defer();\n\n    // remove text selection, to hide still-open editors\n    window.getSelection().removeAllRanges();\n\n    var $cardClone = document.querySelector('.js-card-container').cloneNode(true);\n    $cardClone.classList.add('card-invisible');\n\n    // add the card to the dom before converting to em\n    // so we can getComputedStyle\n    document.body.appendChild($cardClone);\n\n    // before generation, turn all px values to em for up-scaling\n    fixPxSizes($cardClone);\n\n    // double it up only after the px->em conversion\n    $cardClone.classList.add('card-big');\n\n    model.loadingCard = true;\n\n    html2canvas($cardClone, {\n      letterRendering: true\n    })\n    .then(function(canvas) {\n      document.body.removeChild($cardClone);\n      model.loadingCard = false;\n\n      deferred.resolve(canvas);\n\n      // callback for Karma\n      cb(canvas);\n    });\n\n    return deferred.promise;\n\n  };\n\n  $scope.DownloadPdf = function() {\n    $scope.generatePicture()\n    .then(function(canvas) {\n      var imgData = canvas.toDataURL('image/jpeg', 1.0);\n      window.GeneratePdf(model.pdfFilename, imgData);\n    });\n  };\n\n  $scope.DownloadPicture = function() {\n\n    $scope.generatePicture()\n    .then(function(canvas) {\n\n      // make the canvas a blob, so we can download it with downloadify\n      canvas.toBlob(\n        function (blob) {\n\n          var filename = model.imageFilename + '-' + model.store.theme + model.imageExt;\n\n          // saveAs is global from FileSaver.js\n          // FileSaver is included in jsPdf\n          saveAs(blob, filename);\n\n          // scroll back to the card\n          // since saveAs scrolls to the top\n          var $cardContainer = $('.card-container');\n          $cardContainer[0].scrollIntoView(true);\n\n        },\n        'image/jpeg'\n      );\n\n    });\n  };\n\n  var allTemplates = 1;\n  var loadedTemplates = 0;\n  $scope.$on('$includeContentLoaded', function() {\n    // when loading all the includes\n    loadedTemplates++;\n    if (loadedTemplates !== allTemplates) {\n      return;\n    }\n\n    // init foundation plugins - modal and dropdown\n    $(document.querySelector('.card-editor')).foundation();\n\n    // hack to prevent automatic scrolling from contenteditable\n    var $cardContent = document.querySelector('.card-content');\n    if($cardContent) {\n      /* Feature detection */\n      var passiveSupported = false;\n      try {\n        window.addEventListener('test', null, Object.defineProperty({}, 'passive', { get: function() { passiveSupported = true; } }));\n      } catch(err) {}\n\n      $cardContent.addEventListener('scroll', function(event) {\n        $cardContent.scrollTop = 0;\n        $cardContent.scrollLeft = 0;\n      }, passiveSupported ? {passive: true} : true);\n    }\n\n  });\n\n}]);\n","angular.module('businessCardMaker').run(['$templateCache', function($templateCache) {\n  'use strict';\n\n  $templateCache.put('views/cardeditor.html',\n    \"<h2>\\n\" +\n    \"  Customize your business card\\n\" +\n    \"\\n\" +\n    \"  <button type=\\\"button\\\" class=\\\"button small muted btn-reset\\\" ng-click=\\\"ResetCard()\\\" title=\\\"Undo all the styling changes you made. The text and logo will stay the same.\\\">\\n\" +\n    \"    <i class=\\\"fa fa-undo\\\"></i>\\n\" +\n    \"    Reset changes\\n\" +\n    \"  </button>\\n\" +\n    \"</h2>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"card-container js-card-container\\\" ng-class=\\\"{ ' state-loading': model.loadingCard }\\\">\\n\" +\n    \"  <div class=\\\"card-preview {{ model.store.theme }}\\\">\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"card-content\\\">\\n\" +\n    \"\\n\" +\n    \"      <input type=\\\"file\\\" id=\\\"picture-upload\\\" class=\\\"file-upload\\\" fileread=\\\"model.cardPictureFile\\\">\\n\" +\n    \"\\n\" +\n    \"      <div class=\\\"card-picture\\\" dr-container=\\\".card-content\\\" dr-model=\\\"model.store.position.picture\\\" dr-grid=\\\"10\\\">\\n\" +\n    \"\\n\" +\n    \"        <label for=\\\"picture-upload\\\" ng-class=\\\"{ 'no-picture': !model.cardPicture }\\\" title=\\\"Click to upload your own logo\\\">\\n\" +\n    \"\\n\" +\n    \"          <i class=\\\"fa fa-picture-o\\\"></i>\\n\" +\n    \"          <span>Upload your logo</span>\\n\" +\n    \"\\n\" +\n    \"          <img ng-src=\\\"{{ model.cardPicture }}\\\">\\n\" +\n    \"\\n\" +\n    \"        </label>\\n\" +\n    \"      </div>\\n\" +\n    \"\\n\" +\n    \"      <div class=\\\"card-item person\\\" dr-container=\\\".card-content\\\" dr-model=\\\"model.store.position.person\\\" dr-grid=\\\"10\\\">\\n\" +\n    \"\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.name\\\" class=\\\"fn\\\"></p>\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.position\\\" class=\\\"title\\\"></p>\\n\" +\n    \"\\n\" +\n    \"      </div>\\n\" +\n    \"\\n\" +\n    \"      <div class=\\\"card-item details\\\" dr-container=\\\".card-content\\\" dr-model=\\\"model.store.position.details\\\" dr-grid=\\\"10\\\">\\n\" +\n    \"\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.organization\\\" class=\\\"org\\\"></p>\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.location\\\" class=\\\"location\\\"></p>\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.phone\\\" class=\\\"tel\\\"></p>\\n\" +\n    \"\\n\" +\n    \"      </div>\\n\" +\n    \"\\n\" +\n    \"      <div class=\\\"card-item email\\\" dr-container=\\\".card-content\\\" dr-model=\\\"model.store.position.email\\\" dr-grid=\\\"10\\\">\\n\" +\n    \"\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.email\\\"></p>\\n\" +\n    \"\\n\" +\n    \"      </div>\\n\" +\n    \"\\n\" +\n    \"      <div class=\\\"card-item url\\\" dr-container=\\\".card-content\\\" dr-model=\\\"model.store.position.url\\\" dr-grid=\\\"10\\\">\\n\" +\n    \"\\n\" +\n    \"        <p meditor ng-model=\\\"model.store.card.url\\\"></p>\\n\" +\n    \"\\n\" +\n    \"      </div>\\n\" +\n    \"\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"  </div>\\n\" +\n    \"\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<ul class=\\\"download-buttons\\\">\\n\" +\n    \"  <li class=\\\"order-btn order-btn-psprint\\\">\\n\" +\n    \"\\n\" +\n    \"    <button class=\\\"button secondary js-order-btn-psprint js-track-order\\\" ng-click=\\\"DownloadPicture()\\\">\\n\" +\n    \"      <i class=\\\"fa fa-shopping-cart\\\"></i>\\n\" +\n    \"      60% Off Business Cards\\n\" +\n    \"\\n\" +\n    \"      <small>\\n\" +\n    \"        Get your business cards printed and delivered at the best quality and price!\\n\" +\n    \"      </small>\\n\" +\n    \"\\n\" +\n    \"      <span class=\\\"button-promo\\\">\\n\" +\n    \"        Ends {{ model.promoExpire | date:'MM.dd.yy' }}\\n\" +\n    \"      </span>\\n\" +\n    \"    </button>\\n\" +\n    \"\\n\" +\n    \"    <p class=\\\"partner-text\\\">\\n\" +\n    \"      Powered by\\n\" +\n    \"      <a href=\\\"http://www.shareasale.com/r.cfm?b=283670&u=1215865&m=22819&urllink=&afftrack=\\\" target=\\\"_blank\\\">\\n\" +\n    \"        PsPrint\\n\" +\n    \"      </a>\\n\" +\n    \"    </p>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"popover js-laborday-promo\\\">\\n\" +\n    \"      <a target=\\\"_blank\\\" href=\\\"https://shareasale.com/u.cfm?d=530598&m=22819&u=1215865&afftrack=\\\">\\n\" +\n    \"        Labor Day Sale! Take an additional 5% off your PsPrint purchase with this stackable code: SAL50\\n\" +\n    \"      </a>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"  </li>\\n\" +\n    \"  <li>\\n\" +\n    \"\\n\" +\n    \"    <a data-toggle=\\\"drop-downloads\\\" class=\\\"button muted button-download js-download-dropdown-btn float-right\\\">\\n\" +\n    \"      <i class=\\\"fa fa-arrow-circle-o-down\\\"></i>\\n\" +\n    \"      <span>Download as...</span>\\n\" +\n    \"    </a>\\n\" +\n    \"\\n\" +\n    \"    <div id=\\\"drop-downloads\\\" class=\\\"dropdown-pane bottom dropdown-download-files\\\" data-dropdown data-close-on-click=\\\"true\\\">\\n\" +\n    \"      <button type=\\\"button\\\" ng-click=\\\"DownloadPdf()\\\" class=\\\"button-download-file js-track-pdf\\\">\\n\" +\n    \"        <i class=\\\"fa fa-file-text\\\"></i>\\n\" +\n    \"        Download as PDF\\n\" +\n    \"      </button>\\n\" +\n    \"\\n\" +\n    \"      <button type=\\\"button\\\" ng-click=\\\"DownloadPicture()\\\" class=\\\"button-download-file js-track-picture\\\">\\n\" +\n    \"        <i class=\\\"fa fa-picture-o\\\"></i>\\n\" +\n    \"        Download as JPEG\\n\" +\n    \"      </button>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"  </li>\\n\" +\n    \"</ul>\\n\" +\n    \"\\n\"\n  );\n\n}]);\n"]}