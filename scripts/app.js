(()=>{function o(e,t){return!!e.className&&-1!==(" "+e.className+" ").indexOf(t=" "+t+" ")}window.util={closest:function(e,t){for(var o;e&&e!==document;){if(!e.parentNode)return null;if(o=e.parentNode.querySelectorAll(t),-1!==[].indexOf.call(o,e))return e;e=e.parentNode}return null},hash:function(e){var t=window.location.hash.substr(1);return(t=t.substr(t.indexOf(e+"=")).split("&")[0].split("=")[1])||null},hasClass:o,addClass:function(e,t){return o(e,t)||(e.className&&(t=" "+t),e.className+=t),e.className},removeClass:function(e,t){var o=" "+t,r=t+" ";return-1!==e.className.indexOf(o)?e.className=e.className.replace(o,""):-1!==e.className.indexOf(r)?e.className=e.className.replace(r,""):e.className=e.className.replace(t,""),e.className}}})(),(()=>{if("object"==typeof localStorage)try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(e){window.Storage.prototype._setItem=window.Storage.prototype.setItem,window.Storage.prototype.setItem=function(){}}var e=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),t=document.querySelector(".warning-safari");e&&(t.className+="warning-safari-show")})(),(()=>{var e,t,o=document.querySelector(".themes-box");function r(){(e=window.util.hash("theme"))?((t=o.querySelector(".active"))&&window.util.removeClass(t,"active"),(t=o.querySelector(".js-"+e))&&window.util.addClass(t,"active")):o.querySelector(".theme-item").click()}o&&(r(),window.addEventListener("hashchange",r,!1))})(),window.GeneratePdf=(()=>{var e=[3.75,2.25],r=.35,t=.125,a=e[0],n=e[1],o=.06,i=[{x:e=t+r,y:o,x1:e,y1:e-o},{x:o,y:e,x1:e-o,y1:e},{x:a+(t=r-t),y:o,x1:a+t,y1:e-o},{x:a+t+o,y:e,x1:a+2*r-o,y1:e},{x:e,y:n+t+o,x1:e,y1:n+2*r-o},{x:o,y:n+t,x1:e-o,y1:n+t},{x:a+t,y:n+t+o,x1:a+t,y1:n+2*r-o},{x:a+t+o,y:n+t,x1:a+2*r-o,y1:n+t}];return function(e,t){var o=new jsPDF("landscape","in",[a+2*r,n+2*r]);o.addImage(t,"JPEG",r,r,a,n),i.forEach(function(e){o.setLineWidth(.01),o.line(e.x,e.y,e.x1,e.y1)}),o.save(e)}})();var app=angular.module("businessCardMaker",["angular-meditor"]);app.run(["$rootScope",function(e){e.root={}}]),app.directive("fileread",[function(){return{scope:{fileread:"="},link:function(t,e){e.bind("change",function(e){t.$apply(function(){t.fileread=e.target.files[0]})})}}}]),app.directive("drModel",["$document","$timeout",function(){return{template:'<div class="dr-container"><div class="drag-handle"></div><div class="resize-handle"></div><div ng-transclude></div></div>',scope:{drModel:"=",drContainer:"@",drGrid:"@"},replace:!0,transclude:!0,link:function(o,i){function r(e){return e%M==0?e:e-e%M}function t(e){var t;(E||b)&&(e.preventDefault(),v=r(e.touches[0].pageX-g),y=r(e.touches[0].pageY-w),x<v&&(v=x),C<y&&(y=C),E&&(t="translate3d("+(v=v<S?S:v)+"px ,"+(y=y<L?L:y)+"px, 0)",angular.forEach(p,function(e){i.css(e,t)})),b)&&(e=i._startHeight+y,i.css("height",e),e=i._startWidth+v,i.css("width",e))}function e(){var e,t;(E||b)&&(E&&(E=!1,angular.forEach(p,function(e){i.css(e,"")}),e=v,t=y,"absolute"===i.css("position")?(e+=i[0].offsetLeft,t+=i[0].offsetTop):(i.css("left")&&"auto"!==i.css("left")&&(e=parseInt(i.css("left"),10)+v),i.css("top")&&"auto"!==i.css("top")&&(t=parseInt(i.css("top"),10)+y)),i.css({top:t,left:e,bottom:"auto",right:"auto"}),o.drModel)&&(o.drModel.x=e,o.drModel.y=t),b&&(b=!1,o.drModel)&&(o.drModel.width=parseInt(i.css("width")),o.drModel.height=parseInt(i.css("height"))),u.classList.remove(l),i[0].classList.remove(d))}function a(e){var t,o,r,a,n=e.target;t=m.getBoundingClientRect(),o=f.getBoundingClientRect(),r=t.top,a=t.left,L=r-o.top,L=0-N(L),C=o.top+o.height-r-t.height,C=N(C),S=a-o.left,S=0-N(S),x=o.left+o.width-a-t.width,x=N(x),v=y=0,g=e.touches[0].pageX-v,w=e.touches[0].pageY-y,n===h?(b=!0,i._startHeight=parseInt(i.css("height")),i._startWidth=parseInt(i.css("width"))):E=!0,u.classList.add(l),i[0].classList.add(d)}function n(e){return e.touches=[{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}],e}var c,s,l="dr-active",d="dr-handle-show",u=document.getElementsByTagName("body")[0],f=u,m=(o.drContainer&&(f=document.querySelector(o.drContainer)),i[0].querySelector(".drag-handle")),h=i[0].querySelector(".resize-handle"),p=["webkitTransform","msTransform","transform"],g=0,w=0,v=0,y=0,S=0,x=0,L=0,C=0,E=!1,b=!1,M=o.drGrid,N=function(e){return Math.floor(e/M)*M};o.$watch("drModel",function(){o.drModel.x=o.drModel.x||"",i.css({left:o.drModel.x}),o.drModel.y=o.drModel.y||"",i.css({top:o.drModel.y}),o.drModel.width=o.drModel.width||"",i.css({width:o.drModel.width}),o.drModel.height=o.drModel.height||"",i.css({height:o.drModel.height})},!0),h.addEventListener("mousedown",function(e){a(n(e))}),h.addEventListener("touchstart",a),m.addEventListener("mousedown",function(e){a(n(e))}),m.addEventListener("touchstart",a),document.addEventListener("mousemove",function(e){t(n(e))}),document.addEventListener("touchmove",t),document.addEventListener("mouseup",e),document.addEventListener("touchend",e),window.addEventListener("scroll",function(){E?(u.scrollTop=c,u.scrollLeft=s):(c=u.scrollTop,s=u.scrollLeft)})}}}]),app.controller("MainCtrl",["$rootScope","$scope","$location","$timeout","$q",function(e,t,o,r,i){function c(o){var e=window.getComputedStyle(o.parentNode,null),r=window.getComputedStyle(o,null),a=parseFloat(r.fontSize),n=parseFloat(e.fontSize),i="",c={};["left","top","width","height"].forEach(function(e){var t;(i=o.style[e])&&-1===i.indexOf("em")&&(t=parseFloat(r[e])/n,c[e]=(t+=(t-t*(e=a/n))/e)+"em")}),Object.keys(c).forEach(function(e){o.style[e]=c[e]}),"font"===o.tagName.toLowerCase()&&-1===r.fontSize.indexOf("em")&&(o.style.fontSize=a/n+"em")}var a,n,s,l=t.model={cardPictureFile:"",cardPicture:"",imageData:"",imageFilename:"bizcardmaker-com",imageExt:".jpg",pdfData:"",pdfFilename:"bizcardmaker-com.pdf",loadingCard:!1},d=new Date,d=(d.setDate(d.getDate()+23),l.promoExpire=d,l.storeDefaults={card:{name:"John Doe",position:"Position",organization:"Organization",location:"City, State",phone:"(123) 555-1234",email:"john.doe@cmail.com",url:"www.john-doe.com"},position:{picture:{},person:{},details:{},email:{},url:{}}},l.store={card:{},position:{}},angular.copy(l.storeDefaults,l.store),window.localStorage.getItem("bizcardmaker-store")),u=(d&&angular.extend(l.store,angular.fromJson(d)),t.$watch("model.store",(a=function(e){window.localStorage.setItem("bizcardmaker-store",angular.toJson(e))},n=500,function(){var e=this,t=arguments;clearTimeout(s),s=setTimeout(function(){a.apply(e,t)},n)}),!(s=null)),t.ResetCard=function(e){var t;document.querySelector(".card-preview")&&(t=document.querySelector(".card-preview").querySelectorAll("*"),angular.forEach(t,function(e){e.removeAttribute("style")})),e?angular.copy(l.storeDefaults.position,l.store.position):(t=l.store.theme,angular.copy(l.storeDefaults,l.store),l.store.theme=t),window.localStorage.removeItem("bizcardmaker-store")},l.store.theme&&o.search("theme",l.store.theme),t.$on("$locationChangeStart",function(){var e=o.search().theme;e!==l.store.theme&&t.ResetCard(!0),l.store.theme=e}),t.$watch("model.cardPictureFile",function(){var e;l.cardPictureFile&&(l.cardPictureFile.type.match(/image.*/)?((e=new FileReader).onload=function(){r(function(){l.cardPicture=e.result})},e.readAsDataURL(l.cardPictureFile)):window.alert("File not supported!"))}),{1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"}),f=(t.generatePicture=function(t){t=t||function(){};var e,o,r,a=i.defer(),n=(window.getSelection().removeAllRanges(),document.querySelector(".js-card-container").cloneNode(!0));return n.classList.add("card-invisible"),document.body.appendChild(n),r=(e=n).querySelectorAll("[contenteditable]"),angular.forEach(r,function(e){o=e.querySelectorAll("*"),angular.forEach(o,function(e){"font"===e.tagName.toLowerCase()&&(e.style.fontSize=u[e.size]+"px"),c(e)})}),r=e.querySelectorAll(".card-item[style]"),e=e.querySelector(".card-picture[style]"),angular.forEach(r,function(e){c(e)}),e&&c(e),n.classList.add("card-big"),l.loadingCard=!0,html2canvas(n,{letterRendering:!0}).then(function(e){document.body.removeChild(n),l.loadingCard=!1,a.resolve(e),t(e)}),a.promise},t.DownloadPdf=function(){t.generatePicture().then(function(e){e=e.toDataURL("image/jpeg",1);window.GeneratePdf(l.pdfFilename,e)})},t.DownloadPicture=function(){t.generatePicture().then(function(e){e.toBlob(function(e){var t=l.imageFilename+"-"+l.store.theme+l.imageExt;saveAs(e,t),$(".card-container")[0].scrollIntoView(!0)},"image/jpeg")})},0);t.$on("$includeContentLoaded",function(){if(1==++f){$(document.querySelector(".card-editor")).foundation();var e=document.querySelector(".card-content");if(e){var t=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t=!0}}))}catch(e){}e.addEventListener("scroll",function(){e.scrollTop=0,e.scrollLeft=0},!t||{passive:!0})}}})}]);
//# sourceMappingURL=app.js.map