!function(e){"use strict";var i=e.onerror;e.onerror=function(e,t,n,o,a){var r;if(-1!==(t=t||"").indexOf("//www.bizcardmaker.com/"))return"function"==typeof ga&&(r=e,void 0!==a&&void 0!==a.message&&(r=a.message),ga("send","exception",{exDescription:r+=" @ "+t+":"+n+":"+o})),"function"==typeof i&&i(e,t,n,o,a)}}(window),function(){"use strict";function n(e,t){return!!e.className&&-1!==(" "+e.className+" ").indexOf(t=" "+t+" ")}window.util={closest:function(e,t){for(var n;e&&e!==document;){if(!e.parentNode)return null;if(n=e.parentNode.querySelectorAll(t),-1!==[].indexOf.call(n,e))return e;e=e.parentNode}return null},hash:function(e){var t=window.location.hash.substr(1);return(t=t.substr(t.indexOf(e+"=")).split("&")[0].split("=")[1])||null},hasClass:n,addClass:function(e,t){return n(e,t)||(e.className&&(t=" "+t),e.className+=t),e.className},removeClass:function(e,t){var n=" "+t,o=t+" ";return-1!==e.className.indexOf(n)?e.className=e.className.replace(n,""):-1!==e.className.indexOf(o)?e.className=e.className.replace(o,""):e.className=e.className.replace(t,""),e.className}}}(),function(){"use strict";$(document).on("opened","[data-reveal]",function(){$(document.body).addClass("modal-opened")}),$(document).on("closed","[data-reveal]",function(){$(document.body).removeClass("modal-opened")})}(),function(){"use strict";if("object"==typeof localStorage)try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(e){window.Storage.prototype._setItem=window.Storage.prototype.setItem,window.Storage.prototype.setItem=function(){}}var e=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),t=document.querySelector(".warning-safari");e&&(t.className+="warning-safari-show")}(),function(){"use strict";var e=[{selector:".js-track-order",arguments:["Orders","Clicked Print Order button"]},{selector:".js-track-pdf",arguments:["Download","Download PDF"]},{selector:".js-track-picture",arguments:["Download","Download picture"]}];document.body.addEventListener("click",function(t){e.some(function(e){if(window.util.closest(t.target,e.selector))return ga.apply(null,["send","event"].concat(e.arguments)),!0})})}(),function(){"use strict";var t,n,o,a,r=document.querySelector(".js-gtemplates-popup");function e(){var e;o=window.localStorage.getItem(n),(!(e=o)||(e=Date.now()-parseInt(e,10),a<e))&&r.classList.remove(t)}r&&(t="gtemplates-popup-hide",n="gtemplates-popup",o=null,a=864e5,r.querySelector(".js-gtemplates-close").addEventListener("click",function(){r.classList.add(t),window.localStorage.setItem(n,String(Date.now()))}),setTimeout(function(){e()},2e3))}(),function(){"use strict";var e,t,n=document.querySelector(".themes-box");function o(){(e=window.util.hash("theme"))?((t=n.querySelector(".active"))&&window.util.removeClass(t,"active"),(t=n.querySelector(".js-"+e))&&window.util.addClass(t,"active")):n.querySelector(".theme-item").click()}n&&(o(),window.addEventListener("hashchange",o,!1))}(),window.GeneratePdf=function(){"use strict";var e=[3.75,2.25],o=.35,t=.125,a=e[0],r=e[1],e=t+o,t=o-t,n=.06,i=[{x:e,y:n,x1:e,y1:e-n},{x:n,y:e,x1:e-n,y1:e},{x:a+t,y:n,x1:a+t,y1:e-n},{x:a+t+n,y:e,x1:a+2*o-n,y1:e},{x:e,y:r+t+n,x1:e,y1:r+2*o-n},{x:n,y:r+t,x1:e-n,y1:r+t},{x:a+t,y:r+t+n,x1:a+t,y1:r+2*o-n},{x:a+t+n,y:r+t,x1:a+2*o-n,y1:r+t}];return function(e,t){var n=new jsPDF("landscape","in",[a+2*o,r+2*o]);n.addImage(t,"JPEG",o,o,a,r),i.forEach(function(e){n.setLineWidth(.01),n.line(e.x,e.y,e.x1,e.y1)}),n.save(e)}}();var app=angular.module("businessCardMaker",["ngRoute","angular-meditor"]);app.run(["$rootScope",function(e){"use strict";e.root={}}]),app.directive("fileread",[function(){"use strict";return{scope:{fileread:"="},link:function(t,e){e.bind("change",function(e){t.$apply(function(){t.fileread=e.target.files[0]})})}}}]),app.directive("drModel",["$document","$timeout",function(e,t){"use strict";return{template:'<div class="dr-container"><div class="drag-handle"></div><div class="resize-handle"></div><div ng-transclude></div></div>',scope:{drModel:"=",drContainer:"@",drGrid:"@"},replace:!0,transclude:!0,link:function(o,i){function n(e){return e%k==0?e:e-e%k}function t(e){var t;(L||P)&&(e.preventDefault(),v=n(e.touches[0].pageX-h),y=n(e.touches[0].pageY-w),S<v&&(v=S),C<y&&(y=C),L&&(t="translate3d("+(v=v<b?b:v)+"px ,"+(y=y<x?x:y)+"px, 0)",angular.forEach(g,function(e){i.css(e,t)})),P&&(e=i._startHeight+y,i.css("height",e),e=i._startWidth+v,i.css("width",e)))}function e(e){var t,n;(L||P)&&(L&&(L=!1,angular.forEach(g,function(e){i.css(e,"")}),t=v,n=y,"absolute"===i.css("position")?(t+=i[0].offsetLeft,n+=i[0].offsetTop):(i.css("left")&&"auto"!==i.css("left")&&(t=parseInt(i.css("left"),10)+v),i.css("top")&&"auto"!==i.css("top")&&(n=parseInt(i.css("top"),10)+y)),i.css({top:n,left:t,bottom:"auto",right:"auto"}),o.drModel&&(o.drModel.x=t,o.drModel.y=n)),P&&(P=!1,o.drModel&&(o.drModel.width=parseInt(i.css("width")),o.drModel.height=parseInt(i.css("height")))),u.classList.remove(c),i[0].classList.remove(l))}function a(e){var t,n,o,a,r=e.target;t=p.getBoundingClientRect(),n=m.getBoundingClientRect(),o=t.top,a=t.left,x=o-n.top,x=0-D(x),C=n.top+n.height-o-t.height,C=D(C),b=a-n.left,b=0-D(b),S=n.left+n.width-a-t.width,S=D(S),v=y=0,h=e.touches[0].pageX-v,w=e.touches[0].pageY-y,r===f?(P=!0,i._startHeight=parseInt(i.css("height")),i._startWidth=parseInt(i.css("width"))):L=!0,u.classList.add(c),i[0].classList.add(l)}function r(e){return e.touches=[{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}],e}var s,d,c="dr-active",l="dr-handle-show",u=document.getElementsByTagName("body")[0],m=u,p=(o.drContainer&&(m=document.querySelector(o.drContainer)),i[0].querySelector(".drag-handle")),f=i[0].querySelector(".resize-handle"),g=["webkitTransform","msTransform","transform"],h=0,w=0,v=0,y=0,b=0,S=0,x=0,C=0,L=!1,P=!1,k=o.drGrid,D=function(e){return Math.floor(e/k)*k};o.$watch("drModel",function(){o.drModel.x=o.drModel.x||"",i.css({left:o.drModel.x}),o.drModel.y=o.drModel.y||"",i.css({top:o.drModel.y}),o.drModel.width=o.drModel.width||"",i.css({width:o.drModel.width}),o.drModel.height=o.drModel.height||"",i.css({height:o.drModel.height})},!0),f.addEventListener("mousedown",function(e){a(r(e))}),f.addEventListener("touchstart",a),p.addEventListener("mousedown",function(e){a(r(e))}),p.addEventListener("touchstart",a),document.addEventListener("mousemove",function(e){t(r(e))}),document.addEventListener("touchmove",t),document.addEventListener("mouseup",e),document.addEventListener("touchend",e),window.addEventListener("scroll",function(e){L?(u.scrollTop=s,u.scrollLeft=d):(s=u.scrollTop,d=u.scrollLeft)})}}}]),app.controller("MainCtrl",["$rootScope","$scope","$routeParams","$location","$timeout","$q",function(e,t,n,o,a,i){"use strict";function s(n){var e=window.getComputedStyle(n.parentNode,null),o=window.getComputedStyle(n,null),a=parseFloat(o.fontSize),r=parseFloat(e.fontSize),i="",s={};["left","top","width","height"].forEach(function(e){var t;(i=n.style[e])&&-1===i.indexOf("em")&&(t=parseFloat(o[e])/r,s[e]=(t+=(t-t*(e=a/r))/e)+"em")}),Object.keys(s).forEach(function(e){n.style[e]=s[e]}),"font"===n.tagName.toLowerCase()&&-1===o.fontSize.indexOf("em")&&(n.style.fontSize=a/r+"em")}var r,d,c,l=t.model={cardPictureFile:"",cardPicture:"",imageData:"",imageFilename:"bizcardmaker-com",imageExt:".jpg",pdfData:"",pdfFilename:"bizcardmaker-com.pdf",loadingCard:!1},u=new Date,u=(u.setDate(u.getDate()+23),l.promoExpire=u,l.storeDefaults={card:{name:"John Doe",position:"Position",organization:"Organization",location:"City, State",phone:"(123) 555-1234",email:"john.doe@cmail.com",url:"www.john-doe.com"},position:{picture:{},person:{},details:{},email:{},url:{}}},l.store={card:{},position:{}},angular.copy(l.storeDefaults,l.store),window.localStorage.getItem("bizcardmaker-store")),m=(u&&angular.extend(l.store,angular.fromJson(u)),t.$watch("model.store",(r=function(e){window.localStorage.setItem("bizcardmaker-store",angular.toJson(e))},d=500,function(){var e=this,t=arguments;clearTimeout(c),c=setTimeout(function(){r.apply(e,t)},d)}),!(c=null)),t.ResetCard=function(e){var t;document.querySelector(".card-preview")&&(t=document.querySelector(".card-preview").querySelectorAll("*"),angular.forEach(t,function(e){e.removeAttribute("style")})),e?angular.copy(l.storeDefaults.position,l.store.position):(t=l.store.theme,angular.copy(l.storeDefaults,l.store),l.store.theme=t),window.localStorage.removeItem("bizcardmaker-store")},l.store.theme&&o.search("theme",l.store.theme),t.$on("$locationChangeStart",function(){var e=o.search().theme;e!==l.store.theme&&t.ResetCard(!0),l.store.theme=e}),t.$watch("model.cardPictureFile",function(){var e;l.cardPictureFile&&(l.cardPictureFile.type.match(/image.*/)?((e=new FileReader).onload=function(){a(function(){l.cardPicture=e.result})},e.readAsDataURL(l.cardPictureFile)):window.alert("File not supported!"))}),{1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"}),p=(t.generatePicture=function(t){t=t||function(){};var e,n,o,a=i.defer(),r=(window.getSelection().removeAllRanges(),document.querySelector(".js-card-container").cloneNode(!0));return r.classList.add("card-invisible"),document.body.appendChild(r),o=(e=r).querySelectorAll("[contenteditable]"),angular.forEach(o,function(e){n=e.querySelectorAll("*"),angular.forEach(n,function(e){"font"===e.tagName.toLowerCase()&&(e.style.fontSize=m[e.size]+"px"),s(e)})}),o=e.querySelectorAll(".card-item[style]"),e=e.querySelector(".card-picture[style]"),angular.forEach(o,function(e){s(e)}),e&&s(e),r.classList.add("card-big"),l.loadingCard=!0,html2canvas(r,{letterRendering:!0}).then(function(e){document.body.removeChild(r),l.loadingCard=!1,a.resolve(e),t(e)}),a.promise},t.DownloadPdf=function(){t.generatePicture().then(function(e){e=e.toDataURL("image/jpeg",1);window.GeneratePdf(l.pdfFilename,e)})},t.DownloadPicture=function(){t.generatePicture().then(function(e){e.toBlob(function(e){var t=l.imageFilename+"-"+l.store.theme+l.imageExt;saveAs(e,t),$(".card-container")[0].scrollIntoView(!0)},"image/jpeg")})},0);t.$on("$includeContentLoaded",function(){if(1==++p){$(document.querySelector(".card-editor")).foundation();var t=document.querySelector(".card-content");if(t){var e=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){e=!0}}))}catch(e){}t.addEventListener("scroll",function(e){t.scrollTop=0,t.scrollLeft=0},!e||{passive:!0})}}})}]),angular.module("businessCardMaker").run(["$templateCache",function(e){"use strict";e.put("views/cardeditor.html",'<h2>\n  Customize your business card\n\n  <button type="button" class="button small muted btn-reset" ng-click="ResetCard()" title="Undo all the styling changes you made. The text and logo will stay the same.">\n    <i class="fa fa-undo"></i>\n    Reset changes\n  </button>\n</h2>\n\n<div class="card-container js-card-container" ng-class="{ \' state-loading\': model.loadingCard }">\n  <div class="card-preview {{ model.store.theme }}">\n\n    <div class="card-content">\n\n      <input type="file" id="picture-upload" class="file-upload" fileread="model.cardPictureFile">\n\n      <div class="card-picture" dr-container=".card-content" dr-model="model.store.position.picture" dr-grid="10">\n\n        <label for="picture-upload" ng-class="{ \'no-picture\': !model.cardPicture }" title="Click to upload your own logo">\n\n          <i class="fa fa-picture-o"></i>\n          <span>Upload your logo</span>\n\n          <img ng-src="{{ model.cardPicture }}">\n\n        </label>\n      </div>\n\n      <div class="card-item person" dr-container=".card-content" dr-model="model.store.position.person" dr-grid="10">\n\n        <p meditor ng-model="model.store.card.name" class="fn"></p>\n        <p meditor ng-model="model.store.card.position" class="title"></p>\n\n      </div>\n\n      <div class="card-item details" dr-container=".card-content" dr-model="model.store.position.details" dr-grid="10">\n\n        <p meditor ng-model="model.store.card.organization" class="org"></p>\n        <p meditor ng-model="model.store.card.location" class="location"></p>\n        <p meditor ng-model="model.store.card.phone" class="tel"></p>\n\n      </div>\n\n      <div class="card-item email" dr-container=".card-content" dr-model="model.store.position.email" dr-grid="10">\n\n        <p meditor ng-model="model.store.card.email"></p>\n\n      </div>\n\n      <div class="card-item url" dr-container=".card-content" dr-model="model.store.position.url" dr-grid="10">\n\n        <p meditor ng-model="model.store.card.url"></p>\n\n      </div>\n\n    </div>\n\n  </div>\n\n</div>\n\n<ul class="download-buttons">\n  <li class="order-btn">\n    <a href="https://shrsl.com/2kegh" class="button secondary js-track-order" target="_blank">\n      <i class="fa fa-shopping-cart"></i>\n      Get Printed Business Cards\n\n      <small>\n        Get 500 premium quality printed business cards for only <del>$28.45</del> <strong>$19.15</strong>!\n      </small>\n    </a>\n\n    <p class="partner-text">\n      Powered by\n      <a href="https://shrsl.com/2kegh" target="_blank">\n        PGPrint\n      </a>\n    </p>\n  </li>\n  <li>\n\n    <a data-toggle="drop-downloads" class="button muted button-download js-download-dropdown-btn float-right">\n      <i class="fa fa-arrow-circle-o-down"></i>\n      <span>Download as...</span>\n    </a>\n\n    <div id="drop-downloads" class="dropdown-pane bottom dropdown-download-files" data-dropdown data-close-on-click="true">\n      <button type="button" ng-click="DownloadPdf()" class="button-download-file js-track-pdf">\n        <i class="fa fa-file-text"></i>\n        Download as PDF\n      </button>\n\n      <button type="button" ng-click="DownloadPicture()" class="button-download-file js-track-picture">\n        <i class="fa fa-picture-o"></i>\n        Download as JPEG\n      </button>\n    </div>\n\n  </li>\n</ul>\n\n')}]);
//# sourceMappingURL=app.js.map