(()=>{function o(e,t){return!!e.className&&-1!==(" "+e.className+" ").indexOf(t=" "+t+" ")}window.util={closest:function(e,t){for(var o;e&&e!==document;){if(!e.parentNode)return null;if(o=e.parentNode.querySelectorAll(t),-1!==[].indexOf.call(o,e))return e;e=e.parentNode}return null},hash:function(e){var t=window.location.hash.substr(1);return(t=t.substr(t.indexOf(e+"=")).split("&")[0].split("=")[1])||null},hasClass:o,addClass:function(e,t){return o(e,t)||(e.className&&(t=" "+t),e.className+=t),e.className},removeClass:function(e,t){var o=" "+t,a=t+" ";return-1!==e.className.indexOf(o)?e.className=e.className.replace(o,""):-1!==e.className.indexOf(a)?e.className=e.className.replace(a,""):e.className=e.className.replace(t,""),e.className}}})(),(()=>{if("object"==typeof localStorage)try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(e){window.Storage.prototype._setItem=window.Storage.prototype.setItem,window.Storage.prototype.setItem=function(){}}var e=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),t=document.querySelector(".warning-safari");e&&(t.className+="warning-safari-show")})(),(()=>{var e,t,o=document.querySelector(".themes-box");function a(){(e=window.util.hash("theme"))?((t=o.querySelector(".active"))&&window.util.removeClass(t,"active"),(t=o.querySelector(".js-"+e))&&window.util.addClass(t,"active")):o.querySelector(".theme-item").click()}o&&(a(),window.addEventListener("hashchange",a,!1))})(),window.GeneratePdf=(()=>{var e=[3.75,2.25],a=.35,t=.125,r=e[0],n=e[1],o=.06,i=[{x:e=t+a,y:o,x1:e,y1:e-o},{x:o,y:e,x1:e-o,y1:e},{x:r+(t=a-t),y:o,x1:r+t,y1:e-o},{x:r+t+o,y:e,x1:r+2*a-o,y1:e},{x:e,y:n+t+o,x1:e,y1:n+2*a-o},{x:o,y:n+t,x1:e-o,y1:n+t},{x:r+t,y:n+t+o,x1:r+t,y1:n+2*a-o},{x:r+t+o,y:n+t,x1:r+2*a-o,y1:n+t}];return function(e,t){var o=new jsPDF("landscape","in",[r+2*a,n+2*a]);o.addImage(t,"JPEG",a,a,r,n),i.forEach(function(e){o.setLineWidth(.01),o.line(e.x,e.y,e.x1,e.y1)}),o.save(e)}})();var app=angular.module("businessCardMaker",["angular-meditor"]);app.run(["$rootScope",function(e){e.root={}}]),app.directive("fileread",[function(){return{scope:{fileread:"="},link:function(t,e){e.bind("change",function(e){t.$apply(function(){t.fileread=e.target.files[0]})})}}}]),app.directive("drModel",["$document","$timeout",function(){return{template:'<div class="dr-container"><div class="drag-handle"></div><div class="resize-handle"></div><div ng-transclude></div></div>',scope:{drModel:"=",drContainer:"@",drGrid:"@"},replace:!0,transclude:!0,link:function(o,i){function a(e){return e%N==0?e:e-e%N}function t(e){var t;(C||E)&&(e.preventDefault(),v=a(e.touches[0].pageX-g),y=a(e.touches[0].pageY-w),S<v&&(v=S),M<y&&(y=M),C&&(t="translate3d("+(v=v<x?x:v)+"px ,"+(y=y<L?L:y)+"px, 0)",angular.forEach(h,function(e){i.css(e,t)})),E)&&(e=i._startHeight+y,i.css("height",e),e=i._startWidth+v,i.css("width",e))}function e(){var e,t;(C||E)&&(C&&(C=!1,angular.forEach(h,function(e){i.css(e,"")}),e=v,t=y,"absolute"===i.css("position")?(e+=i[0].offsetLeft,t+=i[0].offsetTop):(i.css("left")&&"auto"!==i.css("left")&&(e=parseInt(i.css("left"),10)+v),i.css("top")&&"auto"!==i.css("top")&&(t=parseInt(i.css("top"),10)+y)),i.css({top:t,left:e,bottom:"auto",right:"auto"}),o.drModel)&&(o.drModel.x=e,o.drModel.y=t),E&&(E=!1,o.drModel)&&(o.drModel.width=parseInt(i.css("width")),o.drModel.height=parseInt(i.css("height"))),u.classList.remove(d),i[0].classList.remove(l))}function r(e){var t,o,a,r,n=e.target;t=f.getBoundingClientRect(),o=m.getBoundingClientRect(),a=t.top,r=t.left,L=a-o.top,L=0-b(L),M=o.top+o.height-a-t.height,M=b(M),x=r-o.left,x=0-b(x),S=o.left+o.width-r-t.width,S=b(S),v=y=0,g=e.touches[0].pageX-v,w=e.touches[0].pageY-y,n===p?(E=!0,i._startHeight=parseInt(i.css("height")),i._startWidth=parseInt(i.css("width"))):C=!0,u.classList.add(d),i[0].classList.add(l)}function n(e){return e.touches=[{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}],e}var s,c,d="dr-active",l="dr-handle-show",u=document.getElementsByTagName("body")[0],m=u,f=(o.drContainer&&(m=document.querySelector(o.drContainer)),i[0].querySelector(".drag-handle")),p=i[0].querySelector(".resize-handle"),h=["webkitTransform","msTransform","transform"],g=0,w=0,v=0,y=0,x=0,S=0,L=0,M=0,C=!1,E=!1,N=o.drGrid,b=function(e){return Math.floor(e/N)*N};o.$watch("drModel",function(){o.drModel.x=o.drModel.x||"",i.css({left:o.drModel.x}),o.drModel.y=o.drModel.y||"",i.css({top:o.drModel.y}),o.drModel.width=o.drModel.width||"",i.css({width:o.drModel.width}),o.drModel.height=o.drModel.height||"",i.css({height:o.drModel.height})},!0),p.addEventListener("mousedown",function(e){r(n(e))}),p.addEventListener("touchstart",r),f.addEventListener("mousedown",function(e){r(n(e))}),f.addEventListener("touchstart",r),document.addEventListener("mousemove",function(e){t(n(e))}),document.addEventListener("touchmove",t),document.addEventListener("mouseup",e),document.addEventListener("touchend",e),window.addEventListener("scroll",function(){C?(u.scrollTop=s,u.scrollLeft=c):(s=u.scrollTop,c=u.scrollLeft)})}}}]),app.controller("MainCtrl",["$rootScope","$scope","$location","$timeout","$q",function(e,t,o,a,r){var n,i,s,c=t.model={cardPictureFile:"",cardPicture:"",imageData:"",imageFilename:"bizcardmaker-com",imageExt:".jpg",pdfData:"",pdfFilename:"bizcardmaker-com.pdf",loadingCard:!1},d=new Date,d=(d.setDate(d.getDate()+23),c.promoExpire=d,c.storeDefaults={card:{name:"John Doe",position:"Position",organization:"Organization",location:"City, State",phone:"(123) 555-1234",email:"john.doe@cmail.com",url:"www.john-doe.com"},position:{picture:{},person:{},details:{},email:{},url:{}}},c.store={card:{},position:{}},angular.copy(c.storeDefaults,c.store),window.localStorage.getItem("bizcardmaker-store")),l=(d&&angular.extend(c.store,angular.fromJson(d)),t.$watch("model.store",(n=function(e){window.localStorage.setItem("bizcardmaker-store",angular.toJson(e))},i=500,function(){var e=this,t=arguments;clearTimeout(s),s=setTimeout(function(){n.apply(e,t)},i)}),!(s=null)),t.ResetCard=function(e){var t;document.querySelector(".card-preview")&&(t=document.querySelector(".card-preview").querySelectorAll("*"),angular.forEach(t,function(e){e.removeAttribute("style")})),e?angular.copy(c.storeDefaults.position,c.store.position):(t=c.store.theme,angular.copy(c.storeDefaults,c.store),c.store.theme=t),window.localStorage.removeItem("bizcardmaker-store")},c.store.theme&&o.search("theme",c.store.theme),t.$on("$locationChangeStart",function(){var e=o.search().theme;e!==c.store.theme&&t.ResetCard(!0),c.store.theme=e}),t.$watch("model.cardPictureFile",function(){var e;c.cardPictureFile&&(c.cardPictureFile.type.match(/image.*/)?((e=new FileReader).onload=function(){a(function(){c.cardPicture=e.result})},e.readAsDataURL(c.cardPictureFile)):window.alert("File not supported!"))}),t.generatePicture=async function(){var e=r.defer(),t=(window.getSelection().removeAllRanges(),document.querySelector(".js-card-container")),o=(c.loadingCard=!0,t.classList.add("card-print"),await snapdom(t,{scale:2.12,embedFonts:!0,compress:!1}));return t.classList.remove("card-print"),c.loadingCard=!1,e.resolve(o),e.promise},t.DownloadPdf=function(){t.generatePicture().then(async function(e){e=(await e.toCanvas()).toDataURL("image/jpeg",1);window.GeneratePdf(c.pdfFilename,e)})},t.DownloadPicture=function(){t.generatePicture().then(async function(e){var t=c.imageFilename+"-"+c.store.theme;await e.download({format:"jpg",filename:t})})},0);t.$on("$includeContentLoaded",function(){if(1==++l){$(document.querySelector(".card-editor")).foundation();var e=document.querySelector(".card-content");if(e){var t=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t=!0}}))}catch(e){}e.addEventListener("scroll",function(){e.scrollTop=0,e.scrollLeft=0},!t||{passive:!0})}}})}]);
//# sourceMappingURL=app.js.map